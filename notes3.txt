
How to implement Chosen jquery on rails

ğŸ”— Chosen jQuery plugin >> https://harvesthq.github.io/chosen/
ğŸ”— Gem -> https://github.com/tsechingho/chosen-rails

ğŸ’ add in gemfile >> gem 'chosen-rails'
â• in application.js load after jquery and before our files >> //= require chosen-jquery
â• application.css >>  *= require chosen

ğŸ”— translate coffescript >> http://js2.coffee/
ğŸ”— collection select >> http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_select
ğŸ”— better collection select source >> http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html
â• edit questions.coffee -> questions.js
  $(document).ready(function(){
    $('.chosen-select').chosen({
      allow_single_deselect: true,
      no_results_text: 'No results matched',
      width: '200px'
    });
  });
â•_form.html.erb >>
              f.collection_select
            html options->  { multiple: true }

//////////////////////////////////////////////////////////////////
            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—
            â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
            â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
            â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•â•â•â•â•â•
//////////////////////////////////////////////////////////////////

â• create file config/initializers/setup_mail.rb
    ğŸ“ executed once, if changed you have to restart server
	ActionMailer::Base.smtp_settings = {
  	address:              "smtp.gmail.com",
  	port:                 "587",
  	enable_starttls_auto: true,
  	authentication:       :plain,
  	user_name:            ENV["EMAIL_USER_NAME"],
  	password:             ENV["EMAIL_PASSWORD"]
	}
â• .gitignore
    /config/initializers/app_keys.rb
â• create app_keys.rb file
	ENV["EMAIL_USER_NAME"] = 'answerawesome'
	ENV["EMAIL_PASSWORD"] = 'Sup3r$ecret$$'

ğŸ’» rails g mailer answers_mailer

â• create two views in answers_mailer and edit them

â• edit answersmailer
  def notify_question_owner

ğŸ®
  | AnswersMailer.notify_question_owner.deliver_now! ->check for an exception with bang
  | AnswersMailer.notify_question_owner.deliver_now

ans = Answer.last
AnswersMailer.notify_question_owner(ans).deliver_now!

â• config environments development.rb
  config.action_mailer.default_url_options = { host: "localhost:3000" }


ğŸ® ans.question.user
AnswersMailer.notify_question_owner(@answer).deliver_now

ğŸ’» to see console history in terminal
  atom ~/.irbhistory

â• answers controller
  AnswersMailer.notify_question_owner(@answer).deliver_now

ğŸ®  check environment in console
    Rails.env >> development
ğŸ’ gem letter opener
    add to gemfile >>   gem 'letter_opener'
ğŸ”— https://github.com/ryanb/letter_opener

â• config environments development.rb
    config.action_mailer.delivery_method = :letter_opener

    //STYLING EMAILS >>
      inline styling recommended ğŸ‘ >> sometimes mails remove the head
      tables for layouts are better
      Use -> sendgrid or mandrill in production instead of gmail
      ğŸ”— https://sendgrid.com/ âœ…
      ğŸ”— http://www.mandrill.com/

ğŸ’ premailer gem >> converts normal css styles to inline
ğŸ”— https://github.com/premailer/premailer


ruby is blocking, it will wait for the email to send if we only have one server one thread
ğŸ’ delayed job
ğŸ”— https://github.com/collectiveidea/delayed_job

to visualize delayed job
ğŸ’ delayed job web gem
ğŸ”— https://github.com/ejschmitt/delayed_job_web

â•add to gemfile
  gem "delayed_job_web"
  gem 'delayed_job_active_record'

ğŸ’» rails generate delayed_job:active_record
  error!âŒ

ğŸ’ update sinatra
  in gemfile >> gem 'sinatra', '2.0.0.beta2'

ğŸ’» bundle update sinatra

ğŸ’» rails generate delayed_job:active_record

ğŸ“ old rails migration->
    self.up when your run rails db migrate
    self.down when you rollback
    now you just self.change

ğŸ’» rails db:migrate

â• answers controller change deliver_now to deliver_later
    AnswersMailer.notify_question_owner(@answer).deliver_later

â• config/application.rb
    config.active_job.queue_adapter = :delayed_job

How to check the queue
  lets finish setup

â• add routes ->
  match "/delayed_job" => DelayedJobWeb, :anchor => false, via: [:get, :post]
  ğŸ“ match -> get or post or patch

to see delayed jobs >>
  â© go to http://localhost:3000/delayed_job/

to run it open a new process (tab)
ğŸ’» rails jobs:work
